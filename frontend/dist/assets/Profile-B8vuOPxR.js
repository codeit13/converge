import{k,j as p,o as u,w as i,v as O,A as z,y as t,P as F,n as P,M as N,a as T,d as o,g as r,f as n,T as w,V as j,W as J,t as h,b as c,c as D,i as y,F as C,e as U,h as R}from"./index-BEXXmzFv.js";import{_ as B,a as I}from"./CardContent-CROZv9TU.js";import{_ as L}from"./CardDescription-CDStBNGv.js";import{_ as q,a as M}from"./CardTitle-eiU1mWOv.js";import{_}from"./Input-CqZB8EJL.js";import{_ as f}from"./Label-T96GMOLp.js";import{_ as G}from"./Textarea-a3Nx4Io8.js";import{_ as S}from"./Select-54bKIvxi.js";import{_ as v,a as $,b,c as V}from"./SelectValue-Bk171Di9.js";import{i as W,_ as A}from"./SelectGroup-DMAtfhZ4.js";import"./clamp-Bivrka6k.js";const H=k({__name:"SelectLabel",props:{for:{},asChild:{type:Boolean},as:{default:"div"}},setup(l){const s=l,e=W({id:""});return(a,m)=>(u(),p(t(F),z(s,{id:t(e).id}),{default:i(()=>[O(a.$slots,"default")]),_:3},16,["id"]))}}),E={__name:"SelectLabel",props:{for:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},class:{type:null,required:!1}},setup(l){const s=l;return(e,a)=>(u(),p(t(H),{class:P(t(N)("px-2 py-1.5 text-sm font-semibold",s.class))},{default:i(()=>[O(e.$slots,"default")]),_:3},8,["class"]))}},Q={class:"space-y-4"},X={class:"space-y-2"},Y={class:"flex items-center gap-4"},Z={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},K={class:"space-y-2"},x={class:"space-y-2"},ee={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ae={class:"space-y-2"},te={class:"space-y-2"},se={class:"grid grid-cols-1 gap-4"},oe={class:"space-y-2"},ie={class:"space-y-2"},le={class:"flex flex-col-reverse sm:flex-row justify-end gap-3 sm:gap-4"},re={computed:{...T("auth",["user"])},watch:{user:{immediate:!0,handler(l){l?this.loadUserProfile():this.$router.push("/auth/login")}}},data(){return{languages:[{code:"en",name:"English"},{code:"es",name:"Spanish"},{code:"fr",name:"French"},{code:"de",name:"German"},{code:"it",name:"Italian"},{code:"pt",name:"Portuguese"},{code:"ru",name:"Russian"},{code:"ja",name:"Japanese"},{code:"ko",name:"Korean"},{code:"zh",name:"Chinese"}],timezones:["UTC","UTC+1","UTC+2","UTC+3","UTC+4","UTC+5","UTC+5:30","UTC+6","UTC+7","UTC+8","UTC+9","UTC+10","UTC+11","UTC+12","UTC-1","UTC-2","UTC-3","UTC-4","UTC-5","UTC-6","UTC-7","UTC-8","UTC-9","UTC-10","UTC-11","UTC-12"],formData:{name:"",email:"",profile:{avatar:"",phone:"",bio:"",language:"en",timezone:"UTC"}},originalData:null}},computed:{...T("auth",["user"]),getInitials(){var l;return((l=this.formData.name)==null?void 0:l.split(" ").map(s=>s[0]).join("").toUpperCase())||"U"},hasChanges(){return this.originalData?this.formData.name!==this.originalData.name||this.formData.email!==this.originalData.email?!0:["avatar","phone","bio","language","timezone"].some(s=>this.formData.profile[s]!==this.originalData.profile[s]):!1}},watch:{user:{immediate:!0,handler(l){l?l&&this.loadUserProfile():this.$router.push("/auth/login")}}},methods:{loadUserProfile(){var l,s,e,a,m;if(this.user){const g={name:this.user.name||"",email:this.user.email||"",profile:{avatar:((l=this.user.profile)==null?void 0:l.avatar)||"",phone:((s=this.user.profile)==null?void 0:s.phone)||"",bio:((e=this.user.profile)==null?void 0:e.bio)||"",language:((a=this.user.profile)==null?void 0:a.language)||"en",timezone:((m=this.user.profile)==null?void 0:m.timezone)||"UTC"}};this.formData=JSON.parse(JSON.stringify(g)),this.originalData=JSON.parse(JSON.stringify(g))}},async handleSubmit(){var l,s;try{const e={};if(Object.keys(this.formData).forEach(a=>{a==="profile"?Object.keys(this.formData.profile).forEach(m=>{JSON.stringify(this.formData.profile[m])!==JSON.stringify(this.originalData.profile[m])&&(e[m]=this.formData.profile[m])}):JSON.stringify(this.formData[a])!==JSON.stringify(this.originalData[a])&&(e[a]=this.formData[a])}),Object.keys(e).length>0){const a=await this.$store.dispatch("auth/updateProfile",e);a!=null&&a.status&&(this.originalData={...this.formData})}}catch(e){this.$store.commit("SET_TOASTER_DATA",{type:"error",message:"Error",description:((s=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:s.message)||"Failed to update profile"},{root:!0})}},async handleImageUpload(){try{const l=document.createElement("input");l.type="file",l.accept="image/*",l.onchange=async s=>{const e=s.target.files[0];if(!e)return;if(e.size>5*1024*1024){this.$store.commit("SET_TOASTER_DATA",{type:"error",message:"Image size should not exceed 5MB"},{root:!0});return}const a=new FileReader;a.readAsDataURL(e),a.onload=async()=>{var m,g;try{const d=a.result;await this.$store.dispatch("auth/updateProfile",{avatar:d}),this.formData.profile.avatar=d,this.originalData.profile.avatar=d,this.$store.commit("SET_TOASTER_DATA",{type:"success",message:"Profile picture updated successfully"},{root:!0})}catch(d){this.$store.commit("SET_TOASTER_DATA",{type:"error",message:((g=(m=d==null?void 0:d.response)==null?void 0:m.data)==null?void 0:g.message)||"Failed to upload image"},{root:!0})}}},l.click()}catch{this.$store.commit("SET_TOASTER_DATA",{type:"error",message:"Failed to handle image upload"},{root:!0})}},resetForm(){this.formData={...this.originalData},this.$store.commit("SET_TOASTER_DATA",{type:"info",message:"Form reset to original values"},{root:!0})}}},De=Object.assign(re,{__name:"Profile",setup(l){return(s,e)=>(u(),p(t(I),{class:"max-w-2xl mx-auto"},{default:i(()=>[o(t(M),null,{default:i(()=>[o(t(q),null,{default:i(()=>e[7]||(e[7]=[r("Profile")])),_:1}),o(t(L),null,{default:i(()=>e[8]||(e[8]=[r("Manage your personal information.")])),_:1})]),_:1}),o(t(B),null,{default:i(()=>[n("form",{onSubmit:e[6]||(e[6]=R((...a)=>s.handleSubmit&&s.handleSubmit(...a),["prevent"])),class:"space-y-6"},[n("div",Q,[n("div",X,[o(t(f),null,{default:i(()=>e[9]||(e[9]=[r("Profile picture")])),_:1}),n("div",Y,[o(t(w),{class:"h-24 w-24"},{default:i(()=>[o(t(j),{src:s.formData.profile.avatar},null,8,["src"]),o(t(J),null,{default:i(()=>[r(h(s.getInitials),1)]),_:1})]),_:1}),o(t(c),{variant:"outline",onClick:s.handleImageUpload},{default:i(()=>e[10]||(e[10]=[r(" Change picture ")])),_:1},8,["onClick"])])]),n("div",Z,[n("div",K,[o(t(f),{for:"name"},{default:i(()=>e[11]||(e[11]=[r("Full Name")])),_:1}),o(t(_),{id:"name",modelValue:s.formData.name,"onUpdate:modelValue":e[0]||(e[0]=a=>s.formData.name=a),placeholder:"John Doe"},null,8,["modelValue"])]),n("div",x,[o(t(f),{for:"email"},{default:i(()=>e[12]||(e[12]=[r("Email")])),_:1}),o(t(_),{id:"email",type:"email",modelValue:s.formData.email,"onUpdate:modelValue":e[1]||(e[1]=a=>s.formData.email=a),placeholder:"john@example.com",readonly:""},null,8,["modelValue"]),e[13]||(e[13]=n("p",{class:"text-sm text-muted-foreground"}," Email cannot be changed ",-1))])]),n("div",ee,[n("div",ae,[o(t(f),{for:"phone"},{default:i(()=>e[14]||(e[14]=[r("Phone")])),_:1}),o(t(_),{id:"phone",type:"tel",modelValue:s.formData.profile.phone,"onUpdate:modelValue":e[2]||(e[2]=a=>s.formData.profile.phone=a),placeholder:"+1234567890"},null,8,["modelValue"])]),n("div",te,[o(t(f),{for:"language"},{default:i(()=>e[15]||(e[15]=[r("Language")])),_:1}),o(t(S),{modelValue:s.formData.profile.language,"onUpdate:modelValue":e[3]||(e[3]=a=>s.formData.profile.language=a)},{default:i(()=>[o(t(v),null,{default:i(()=>[o(t($),{placeholder:"Select your language"})]),_:1}),o(t(b),null,{default:i(()=>[o(t(A),null,{default:i(()=>[o(t(E),null,{default:i(()=>e[16]||(e[16]=[r("Languages")])),_:1}),(u(!0),D(C,null,y(s.languages,a=>(u(),p(t(V),{key:a.code,value:a.code},{default:i(()=>[r(h(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),n("div",se,[n("div",oe,[o(t(f),{for:"timezone"},{default:i(()=>e[17]||(e[17]=[r("Timezone")])),_:1}),o(t(S),{modelValue:s.formData.profile.timezone,"onUpdate:modelValue":e[4]||(e[4]=a=>s.formData.profile.timezone=a)},{default:i(()=>[o(t(v),null,{default:i(()=>[o(t($),{placeholder:"Select your timezone"})]),_:1}),o(t(b),null,{default:i(()=>[o(t(A),null,{default:i(()=>[o(t(E),null,{default:i(()=>e[18]||(e[18]=[r("Timezones")])),_:1}),(u(!0),D(C,null,y(s.timezones,a=>(u(),p(t(V),{key:a,value:a},{default:i(()=>[r(h(a),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),n("div",ie,[o(t(f),{for:"bio"},{default:i(()=>e[19]||(e[19]=[r("Bio")])),_:1}),o(t(G),{id:"bio",modelValue:s.formData.profile.bio,"onUpdate:modelValue":e[5]||(e[5]=a=>s.formData.profile.bio=a),placeholder:"Tell us about yourself",rows:"4"},null,8,["modelValue"])])]),n("div",le,[s.hasChanges?(u(),p(t(c),{key:0,variant:"outline",type:"button",onClick:s.resetForm},{default:i(()=>e[20]||(e[20]=[r(" Reset ")])),_:1},8,["onClick"])):U("",!0),s.hasChanges?(u(),p(t(c),{key:1,type:"submit"},{default:i(()=>e[21]||(e[21]=[r(" Save changes ")])),_:1})):U("",!0)])],32)]),_:1})]),_:1}))}});export{De as default};
