import{c,a as d,o as n,k as N,n as H,u as o,P as A,m as k,b as e,T as f,d as l,w as r,e as u,U as R,_ as g,t as i,V as y,aJ as v,aj as h,aK as S,F as D,r as P,aL as V,f as C}from"./index-CS-aw853.js";import{_ as b}from"./index-Lhove8pD.js";import{_ as L,a as B}from"./CardContent-Dpm6qspC.js";import{_ as F,a as I,b as _}from"./CardTitle-BABack2F.js";import{_ as z,a as U,b as w,c as x}from"./TabsTrigger-K94q_MHc.js";import{L as j,C as T}from"./loader-circle-AX7LySsq.js";/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=c("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=c("CreditCardIcon",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=c("ReceiptIcon",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]),G={__name:"CardFooter",props:{class:{type:null,required:!1}},setup(m){const a=m;return(t,s)=>(n(),d("div",{class:H(o(A)("flex items-center p-6 pt-0",a.class))},[N(t.$slots,"default")],2))}},O={class:"container mx-auto px-4 py-16"},q={class:"flex justify-between items-center mb-8"},Y={key:0,class:"flex justify-center items-center py-12"},J={key:1,class:"max-w-lg mx-auto text-center py-12"},K={class:"text-muted-foreground mb-6"},Z={key:2,class:"max-w-lg mx-auto text-center py-12"},Q={key:3,class:"mb-6 p-4 bg-muted/40 rounded-lg"},W={class:"flex flex-wrap gap-4 mb-4"},X={class:"w-full md:w-auto"},tt={class:"w-full md:w-auto"},et={class:"w-full md:w-auto"},st={class:"w-full md:w-auto"},at={class:"w-full md:w-auto"},it={class:"w-full md:w-auto"},ot={class:"flex justify-end gap-2"},lt={key:4,class:"space-y-6"},nt={class:"flex justify-between items-start"},dt={class:"text-right"},rt={class:"text-xl font-bold"},ut={class:"text-sm text-muted-foreground"},mt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"},ft={class:"font-mono text-sm"},pt={key:0},gt={key:1},yt={class:"text-destructive"},vt={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"},bt={class:"capitalize"},wt={class:"font-mono text-sm"},xt={class:"font-mono text-sm"},ct={key:0},kt={class:"capitalize"},ht={key:1},Dt={key:2},Pt={key:3},Ct={key:4},$t={key:1,class:"py-4 text-center text-muted-foreground"},Ht={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"},Nt={key:0},At={key:1},Rt={key:1,class:"py-4 text-center text-muted-foreground"},St={key:0,class:"grid grid-cols-1 gap-4 mt-4"},Vt={key:0},Lt={key:1},Bt={class:"capitalize"},Ft={key:2},It={class:"list-disc pl-5 space-y-1"},_t={key:0,class:"text-xs text-muted-foreground"},zt={key:1,class:"grid grid-cols-1 gap-4 mt-4"},Ut={class:"font-mono text-sm"},jt={key:0},Tt={key:2,class:"py-4 text-center text-muted-foreground"},Mt={class:"text-sm text-muted-foreground"},Et={class:"font-mono"},Gt={class:"flex gap-2"},Ot={class:"flex items-center justify-between py-4"},qt={class:"flex items-center gap-2"},Yt={class:"text-sm text-muted-foreground"},Jt={class:"flex items-center gap-2"},Kt={class:"text-sm"},Zt={data(){return{filters:{status:"",type:"",gateway:"",startDate:"",endDate:"",sortBy:"",limit:10,page:1}}},computed:{...k("payments",["paymentHistory","isLoading","error"]),...k("auth",["user"]),filteredPayments(){return!this.paymentHistory||!this.paymentHistory.data?[]:this.paymentHistory.data.payments||[]},pagination(){return!this.paymentHistory||!this.paymentHistory.data?{page:1,limit:10,totalPages:1,totalResults:0}:this.paymentHistory.data.pagination||{page:1,limit:10,totalPages:1,totalResults:0}}},methods:{async retryLoading(){this.$store.commit("payments/SET_ERROR",null),await this.fetchPaymentHistory()},async fetchPaymentHistory(){const m={};this.filters.status&&(m.status=this.filters.status),this.filters.type&&(m.type=this.filters.type),this.filters.gateway&&(m.gateway=this.filters.gateway),this.filters.startDate&&(m.startDate=this.filters.startDate),this.filters.endDate&&(m.endDate=this.filters.endDate),this.filters.sortBy&&(m.sortBy=this.filters.sortBy),this.filters.limit&&(m.limit=this.filters.limit),this.filters.page&&(m.page=this.filters.page),await this.$store.dispatch("payments/getPaymentHistory",m)},applyFilters(){this.fetchPaymentHistory()},resetFilters(){this.filters={status:"",type:"",gateway:"",startDate:"",endDate:"",sortBy:"",limit:10,page:1},this.fetchPaymentHistory()},prevPage(){this.pagination.page>1&&(this.filters.page=this.pagination.page-1,this.fetchPaymentHistory())},nextPage(){this.pagination.page<this.pagination.totalPages&&(this.filters.page=this.pagination.page+1,this.fetchPaymentHistory())},formatDate(m,a=!1){if(!m)return"N/A";const t={year:"numeric",month:"short",day:"numeric"};return a&&(t.hour="2-digit",t.minute="2-digit"),new Date(m).toLocaleDateString(void 0,t)},getStatusVariant(m){switch(m){case"completed":return"success";case"failed":return"destructive";case"pending":return"warning";default:return"secondary"}},continuePayment(m){this.$store.dispatch("auth/showNotification",{type:"info",message:"Continuing payment process..."})},viewReceipt(m){this.$store.dispatch("auth/showNotification",{type:"info",message:"Generating receipt..."})}},async mounted(){if(!this.user){this.$router.push("/auth/login");return}await this.fetchPaymentHistory()}},ae=Object.assign(Zt,{__name:"PaymentHistory",setup(m){return(a,t)=>(n(),d("div",O,[e("div",q,[t[11]||(t[11]=e("div",null,[e("h1",{class:"text-4xl font-bold"},"Payment History"),e("p",{class:"text-muted-foreground mt-2"}," View all your past transactions ")],-1)),l(o(g),{variant:"outline",onClick:t[0]||(t[0]=s=>a.$router.push("/pricing"))},{default:r(()=>[l(o(R),{class:"h-4 w-4 mr-2"}),t[10]||(t[10]=u(" Back to Plans "))]),_:1})]),a.isLoading?(n(),d("div",Y,[l(o(j),{class:"h-8 w-8 animate-spin text-primary"}),t[12]||(t[12]=e("span",{class:"ml-3 text-lg"},"Loading payment history...",-1))])):a.error?(n(),d("div",J,[l(o(T),{class:"h-12 w-12 text-destructive mx-auto mb-4"}),t[14]||(t[14]=e("h3",{class:"text-lg font-semibold mb-2"},"Failed to Load History",-1)),e("p",K,i(a.error),1),l(o(g),{onClick:a.retryLoading},{default:r(()=>t[13]||(t[13]=[u("Try Again")])),_:1},8,["onClick"])])):a.filteredPayments.length?(n(),d("div",Q,[e("div",W,[e("div",X,[t[19]||(t[19]=e("label",{class:"text-sm font-medium mb-1 block"},"Status",-1)),y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.filters.status=s),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},t[18]||(t[18]=[e("option",{value:""},"All Statuses",-1),e("option",{value:"completed"},"Completed",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"failed"},"Failed",-1)]),512),[[v,a.filters.status]])]),e("div",tt,[t[21]||(t[21]=e("label",{class:"text-sm font-medium mb-1 block"},"Payment Type",-1)),y(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.filters.type=s),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},t[20]||(t[20]=[e("option",{value:""},"All Types",-1),e("option",{value:"subscription"},"Subscription",-1),e("option",{value:"onetime"},"One-time",-1)]),512),[[v,a.filters.type]])]),e("div",et,[t[23]||(t[23]=e("label",{class:"text-sm font-medium mb-1 block"},"Gateway",-1)),y(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>a.filters.gateway=s),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},t[22]||(t[22]=[e("option",{value:""},"All Gateways",-1),e("option",{value:"razorpay"},"Razorpay",-1),e("option",{value:"stripe"},"Stripe",-1)]),512),[[v,a.filters.gateway]])]),e("div",st,[t[24]||(t[24]=e("label",{class:"text-sm font-medium mb-1 block"},"Start Date",-1)),y(e("input",{type:"date","onUpdate:modelValue":t[5]||(t[5]=s=>a.filters.startDate=s),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[h,a.filters.startDate]])]),e("div",at,[t[25]||(t[25]=e("label",{class:"text-sm font-medium mb-1 block"},"End Date",-1)),y(e("input",{type:"date","onUpdate:modelValue":t[6]||(t[6]=s=>a.filters.endDate=s),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},null,512),[[h,a.filters.endDate]])]),e("div",it,[t[27]||(t[27]=e("label",{class:"text-sm font-medium mb-1 block"},"Sort By",-1)),y(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>a.filters.sortBy=s),class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm"},t[26]||(t[26]=[S('<option value="">Default</option><option value="date:desc">Date (Newest)</option><option value="date:asc">Date (Oldest)</option><option value="amount:desc">Amount (High-Low)</option><option value="amount:asc">Amount (Low-High)</option>',5)]),512),[[v,a.filters.sortBy]])])]),e("div",ot,[l(o(g),{variant:"outline",onClick:a.resetFilters},{default:r(()=>t[28]||(t[28]=[u("Reset Filters")])),_:1},8,["onClick"]),l(o(g),{onClick:a.applyFilters},{default:r(()=>t[29]||(t[29]=[u("Apply Filters")])),_:1},8,["onClick"])])])):(n(),d("div",Z,[l(o($),{class:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),t[16]||(t[16]=e("h3",{class:"text-lg font-semibold mb-2"},"No Payment History",-1)),t[17]||(t[17]=e("p",{class:"text-muted-foreground mb-6"}," You haven't made any payments yet. ",-1)),l(o(g),{onClick:t[1]||(t[1]=s=>a.$router.push("/pricing"))},{default:r(()=>t[15]||(t[15]=[u("View Plans")])),_:1})])),a.filteredPayments.length?(n(),d("div",lt,[(n(!0),d(D,null,P(a.filteredPayments,s=>(n(),C(o(B),{key:s.id,class:"overflow-hidden"},{default:r(()=>[l(o(F),{class:"pb-2"},{default:r(()=>[e("div",nt,[e("div",null,[l(o(I),{class:"flex items-center gap-2"},{default:r(()=>{var p;return[u(i(((p=s.metadata)==null?void 0:p.planName)||"Payment")+" ",1),l(o(b),{variant:a.getStatusVariant(s.status)},{default:r(()=>[u(i(s.status),1)]),_:2},1032,["variant"])]}),_:2},1024),l(o(_),null,{default:r(()=>[u(i(a.formatDate(s.createdAt)),1)]),_:2},1024)]),e("div",dt,[e("div",rt,i(s.amount)+" "+i(s.currency),1),e("div",ut,i(s.type),1)])])]),_:2},1024),l(o(L),null,{default:r(()=>[l(o(z),{"default-value":"details",class:"w-full"},{default:r(()=>[l(o(U),{class:"grid w-full grid-cols-4"},{default:r(()=>[l(o(w),{value:"details"},{default:r(()=>t[30]||(t[30]=[u("Details")])),_:1}),l(o(w),{value:"gateway"},{default:r(()=>t[31]||(t[31]=[u("Gateway")])),_:1}),l(o(w),{value:"subscription",disabled:!s.subscription},{default:r(()=>t[32]||(t[32]=[u("Subscription")])),_:2},1032,["disabled"]),l(o(w),{value:"plan",disabled:!s.planData&&!s.metadata},{default:r(()=>t[33]||(t[33]=[u("Plan")])),_:2},1032,["disabled"])]),_:2},1024),l(o(x),{value:"details"},{default:r(()=>[e("div",mt,[e("div",null,[t[34]||(t[34]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Payment ID",-1)),e("p",ft,i(s.paymentId),1)]),e("div",null,[t[35]||(t[35]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Type",-1)),e("p",null,i(s.type),1)]),e("div",null,[t[36]||(t[36]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Created",-1)),e("p",null,i(a.formatDate(s.createdAt,!0)),1)]),e("div",null,[t[37]||(t[37]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Updated",-1)),e("p",null,i(a.formatDate(s.updatedAt,!0)),1)]),s.requestData?(n(),d("div",pt,[t[38]||(t[38]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"IP Address",-1)),e("p",null,i(s.requestData.ipAddress),1)])):f("",!0),s.failureReason&&s.status==="failed"?(n(),d("div",gt,[t[39]||(t[39]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Failure Reason",-1)),e("p",yt,i(s.failureReason.message||"Unknown error"),1)])):f("",!0)])]),_:2},1024),l(o(x),{value:"gateway"},{default:r(()=>[s.gateway?(n(),d("div",vt,[e("div",null,[t[40]||(t[40]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Gateway",-1)),e("p",bt,i(s.gateway.name),1)]),e("div",null,[t[41]||(t[41]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Order ID",-1)),e("p",wt,i(s.gateway.orderId),1)]),e("div",null,[t[42]||(t[42]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Payment ID",-1)),e("p",xt,i(s.gateway.paymentId),1)]),s.gateway.metadata?(n(),d("div",ct,[t[43]||(t[43]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Method",-1)),e("p",kt,i(s.gateway.metadata.method||"N/A"),1)])):f("",!0),s.gateway.metadata&&s.gateway.metadata.bank?(n(),d("div",ht,[t[44]||(t[44]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Bank",-1)),e("p",null,i(s.gateway.metadata.bank),1)])):f("",!0),s.gateway.metadata&&s.gateway.metadata.email?(n(),d("div",Dt,[t[45]||(t[45]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Email",-1)),e("p",null,i(s.gateway.metadata.email),1)])):f("",!0),s.gateway.metadata&&s.gateway.metadata.contact?(n(),d("div",Pt,[t[46]||(t[46]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Contact",-1)),e("p",null,i(s.gateway.metadata.contact),1)])):f("",!0),s.gateway.metadata&&s.gateway.metadata.status?(n(),d("div",Ct,[t[47]||(t[47]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Gateway Status",-1)),l(o(b),{variant:s.gateway.metadata.status==="captured"?"success":"secondary"},{default:r(()=>[u(i(s.gateway.metadata.status),1)]),_:2},1032,["variant"])])):f("",!0)])):(n(),d("div",$t," No gateway information available "))]),_:2},1024),l(o(x),{value:"subscription"},{default:r(()=>[s.subscription?(n(),d("div",Ht,[e("div",null,[t[48]||(t[48]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Status",-1)),l(o(b),{variant:s.subscription.status==="active"?"success":"secondary"},{default:r(()=>[u(i(s.subscription.status),1)]),_:2},1032,["variant"])]),e("div",null,[t[49]||(t[49]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Auto Renew",-1)),l(o(b),{variant:"outline"},{default:r(()=>[u(i(s.subscription.autoRenew?"Yes":"No"),1)]),_:2},1024)]),e("div",null,[t[50]||(t[50]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Start Date",-1)),e("p",null,i(a.formatDate(s.subscription.startDate)),1)]),e("div",null,[t[51]||(t[51]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"End Date",-1)),e("p",null,i(a.formatDate(s.subscription.endDate)),1)]),s.subscription.trialDays?(n(),d("div",Nt,[t[52]||(t[52]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Trial Period",-1)),e("p",null,i(s.subscription.trialDays)+" days",1)])):f("",!0),s.subscription.cancelledAt?(n(),d("div",At,[t[53]||(t[53]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Cancelled On",-1)),e("p",null,i(a.formatDate(s.subscription.cancelledAt)),1)])):f("",!0)])):(n(),d("div",Rt," No subscription information available "))]),_:2},1024),l(o(x),{value:"plan"},{default:r(()=>[s.metadata?(n(),d("div",St,[e("div",null,[t[54]||(t[54]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Plan Name",-1)),e("p",null,i(s.metadata.planName||"N/A"),1)]),s.metadata.planDescription?(n(),d("div",Vt,[t[55]||(t[55]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Description",-1)),e("p",null,i(s.metadata.planDescription),1)])):f("",!0),s.metadata.pricingInterval?(n(),d("div",Lt,[t[56]||(t[56]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Billing Cycle",-1)),e("p",Bt,i(s.metadata.pricingInterval),1)])):f("",!0),s.metadata.features&&s.metadata.features.length?(n(),d("div",Ft,[t[57]||(t[57]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Features",-1)),e("ul",It,[(n(!0),d(D,null,P(s.metadata.features,p=>(n(),d("li",{key:p._id,class:H({"text-muted-foreground":!p.included})},[u(i(p.name)+" ",1),p.description?(n(),d("span",_t," - "+i(p.description),1)):f("",!0)],2))),128))])])):f("",!0)])):s.planData?(n(),d("div",zt,[e("div",null,[t[58]||(t[58]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Plan ID",-1)),e("p",Ut,i(s.plan),1)]),s.planData.name?(n(),d("div",jt,[t[59]||(t[59]=e("h4",{class:"text-sm font-medium text-muted-foreground mb-1"},"Plan Name",-1)),e("p",null,i(s.planData.name),1)])):f("",!0)])):(n(),d("div",Tt," No plan information available "))]),_:2},1024)]),_:2},1024)]),_:2},1024),l(o(G),{class:"flex justify-between border-t pt-4"},{default:r(()=>[e("div",Mt,[t[60]||(t[60]=u(" ID: ")),e("span",Et,i(s.id),1)]),e("div",Gt,[s.status==="pending"?(n(),C(o(g),{key:0,variant:"default",size:"sm",onClick:p=>a.continuePayment(s)},{default:r(()=>[l(o(E),{class:"h-4 w-4 mr-2"}),t[61]||(t[61]=u(" Continue Payment "))]),_:2},1032,["onClick"])):f("",!0),l(o(g),{variant:"outline",size:"sm",onClick:p=>a.viewReceipt(s)},{default:r(()=>[l(o($),{class:"h-4 w-4 mr-2"}),t[62]||(t[62]=u(" View Receipt "))]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128)),e("div",Ot,[e("div",qt,[e("span",Yt," Showing "+i(Math.min(a.pagination.limit,a.pagination.totalResults))+" of "+i(a.pagination.totalResults)+" items ",1),y(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>a.filters.limit=s),class:"h-9 w-16 rounded-md border border-input bg-background px-2 text-sm",onChange:t[9]||(t[9]=(...s)=>a.applyFilters&&a.applyFilters(...s))},t[63]||(t[63]=[e("option",{value:"10"},"10",-1),e("option",{value:"20"},"20",-1),e("option",{value:"50"},"50",-1)]),544),[[v,a.filters.limit]])]),e("div",Jt,[l(o(g),{variant:"outline",size:"sm",disabled:a.pagination.page<=1,onClick:a.prevPage},{default:r(()=>[l(o(M),{class:"h-4 w-4"}),t[64]||(t[64]=u(" Previous "))]),_:1},8,["disabled","onClick"]),e("span",Kt," Page "+i(a.pagination.page)+" of "+i(a.pagination.totalPages),1),l(o(g),{variant:"outline",size:"sm",disabled:a.pagination.page>=a.pagination.totalPages,onClick:a.nextPage},{default:r(()=>[t[65]||(t[65]=u(" Next ")),l(o(V),{class:"h-4 w-4"})]),_:1},8,["disabled","onClick"])])])])):f("",!0)]))}});export{ae as default};
